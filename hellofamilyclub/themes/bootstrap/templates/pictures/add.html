{% extends 'base.html' %}

{% block main %}
    <form id="addFaceForm" action="/api/face/" method="POST" enctype="application/x-www-form-urlencoded">
        {% csrf_token %}
        {{ form.media }}
        {{ form}}
        <button type="button" class="btn btn-primary" id="addFace">提交</button>
    </form>
{% endblock %}

{% block scriptImport %}
    <script src="https://cdn.bootcss.com/axios/0.19.0/axios.min.js"></script>
    <script src="https://cdn.bootcss.com/qs/6.9.0/qs.min.js"></script>
{% endblock %}

{% block script %}
<script>
    const button = document.getElementById("addFace");
    const form = document.getElementById("addFaceForm");
    const se = form.getElementsByTagName('select');
    button.onclick = function() {
        let data = Qs.stringify({
            csrfmiddlewaretoken: $('input[name="csrfmiddlewaretoken"]')[0].value,
            member: parseInt(form.member.value),
            image_url: document.getElementById('id_image_url').value,
            image_file: document.getElementById('id_image_file').value,
        });
        axios({
            url: '/api/face/?format=json',
            method: 'post',
            headers: {'Content-Type': 'application/x-www-form-urlencoded',},
            data: data,
            xsrfCookieName: 'csrftoken',
            xsrfHeaderName: 'X-CSRFToken',
        }
    ).then(function(response) {
            alert(response.data.message);
        }).catch(function(response) {
            alert(response);
        })
    }
</script>
{% endblock %}